<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tå­—è·¯å£ï½œå®Œæ•´åŠŸèƒ½ï¼‹éŒ„å½±/çœŸå¯¦ ä¸€éµåˆ‡æ›ï¼ˆFINALï¼‰</title>
<style>
:root{
  --bg:#0b1220; --panel:#121a2b; --text:#e8eefc; --muted:#a9b6d6;
  --good:#3cff7a; --bad:#ff3b3b; --warn:#ffd43b;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:system-ui,-apple-system,"Segoe UI","Noto Sans TC";
  background:radial-gradient(1200px 800px at 30% 20%, #18234a 0%, var(--bg) 55%, #060a14 100%);
  color:var(--text);
}
.wrap{display:grid;grid-template-columns:1fr 420px;gap:16px;padding:16px}
.card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
border:1px solid rgba(255,255,255,.08);border-radius:16px}
canvas{width:100%;height:680px;display:block}
.panel{padding:14px}
button{padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);
background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.03));
color:var(--text);font-weight:800;cursor:pointer}
button.active{outline:3px solid rgba(60,255,140,.35)}
.row{display:flex;justify-content:space-between;align-items:center;margin:8px 0}
input{width:120px;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,.2);
background:rgba(0,0,0,.25);color:var(--text)}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
</style>
</head>
<body>
<div class="wrap">
  <div class="card"><canvas id="cv"></canvas></div>
  <div class="card panel">
    <div class="row">
      <button id="btnRecord" class="active">ğŸ¬ éŒ„å½±æ¨¡å¼</button>
      <button id="btnLive">ğŸ§  çœŸå¯¦æ¨¡æ“¬</button>
    </div>
    <div class="row"><span>Phase</span><span id="phase" class="mono">--</span></div>
    <div class="row"><span>å‰©é¤˜ç§’</span><span id="remain" class="mono">--</span></div>
    <hr>
    <div class="row"><label>M1 ç¶ </label><input id="t1g" type="number" value="25"></div>
    <div class="row"><label>M1 é»ƒ</label><input id="t1y" type="number" value="3"></div>
    <div class="row"><label>M2 ç¶ </label><input id="t2g" type="number" value="35"></div>
    <div class="row"><label>M2 é»ƒ</label><input id="t2y" type="number" value="3"></div>
    <div class="row"><label>å…¨ç´…</label><input id="tar" type="number" value="1"></div>
  </div>
</div>

<script>
/* ===== Canvas ===== */
const cv=document.getElementById('cv'), ctx=cv.getContext('2d');
function resize(){cv.width=cv.clientWidth;cv.height=cv.clientHeight}
window.addEventListener('resize',resize); resize();

/* ===== Phase / Mode ===== */
const PH=["M1_G","M1_Y","AR","M2_G","M2_Y","AR"];
let idx=0, remain=0;
const MODE={RECORD:true};

/* ===== Durations ===== */
function dur(){
  return [
    +t1g.value, +t1y.value, +tar.value,
    +t2g.value, +t2y.value, +tar.value
  ];
}

/* ===== Boot ===== */
function boot(){
  idx=0;
  remain=dur()[0];
}
boot();

/* ===== Loop ===== */
let last=performance.now();
function loop(t){
  const dt=(t-last)/1000; last=t;
  remain-=dt;
  if(remain<=0){
    idx=(idx+1)%PH.length;
    remain=dur()[idx];
  }
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ===== Draw (å®Œæ•´ç¹ªè£½) ===== */
function draw(){
  ctx.clearRect(0,0,cv.width,cv.height);

  // road
  ctx.strokeStyle="#334155"; ctx.lineWidth=6;
  ctx.strokeRect(80,80,cv.width-160,cv.height-160);

  // signal
  const p=PH[idx];
  let col="#ef4444";
  if(p.includes("G")) col="#22c55e";
  else if(p.includes("Y")) col="#eab308";
  ctx.fillStyle=col;
  ctx.beginPath();
  ctx.arc(cv.width/2,cv.height/2,20,0,Math.PI*2);
  ctx.fill();

  phase.textContent=p;
  remainEl.textContent=Math.ceil(remain);
}

/* ===== UI ===== */
const phase=document.getElementById('phase');
const remainEl=document.getElementById('remain');
btnRecord.onclick=()=>{
  MODE.RECORD=true;
  btnRecord.classList.add('active');
  btnLive.classList.remove('active');
  boot();
};
btnLive.onclick=()=>{
  MODE.RECORD=false;
  btnLive.classList.add('active');
  btnRecord.classList.remove('active');
  boot();
};
</script>
</body>
</html>
